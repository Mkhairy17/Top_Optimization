function xval_opt = optimum_variables (U1,U2,U3,U4,U5,vv1,vv2,vv3)
c = [1 1 1 0 0 0 0]';
setlmis([]);
alpha1=lmivar(2,[1,1]); 
alpha2=lmivar(2,[1,1]);
alpha3=lmivar(2, [1,1]);
alpha4=lmivar(2,[1,1]); 
alpha5=lmivar(2,[1,1]);
alpha6=lmivar(2, [1,1]);
V1 = lmivar(2,[1,1]);
V2 = lmivar(2,[1,1]);
V3 = lmivar(2,[1,1]);
V4 = lmivar(2,[1,1]);
V5 = lmivar(2,[1,1]);
V6 = lmivar(2,[1,1]);
V7 = lmivar(2,[1,1]);
V8 = lmivar(2,[1,1]);
V9 = lmivar(2,[1,1]);
V10 = lmivar(2,[1,1]);
V11 = lmivar(2,[1,1]);
V12 = lmivar(2,[1,1]);
V13 = lmivar(2,[1,1]);
V14 = lmivar(2,[1,1]);
%%======================***========================
F1111 = 1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6);
F1122 = 1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6);
F1133 = 1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5);
F1123 = 1/28 *(V13 + 4 *V4 - 7 *V9);
F1113 = 1/28 *(-3 * V12 + 12* V3 + 7 *V8);
F1112 = 1/56 *(2* V11 + 24 * V2 - 7 * V7);
F2222 = 1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6);
F2233 = 1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5);
F2223 = 1/28 *(3* V13 + 12 *V4 + 7 * V9);
F1223 = 1/28 *(-V12 + 4*  V3 - 7 * V8);
F1222 = 1/56 *(2 * V11 + 24* V2 + 7* V7);
F3333 = 1/35 *(7 + V14 + 10 *V5);
F2333 = 1/7 *(-V13 + 3 *V4);
F1333 = 1/7 *(V12 + 3 *V3);
F1233 = 1/14 *(-V11 + 2 * V2);
%%===================****===========================
%% LMI 1 (A V1;V1' alfa1) >= 0
lmiterm([-1 4 1 0], vv1(1));   %V1'
lmiterm([-1 4 2 0], vv1(2));   %V1'
lmiterm([-1 4 3 0], vv1(3));   %V1'
lmiterm([-1 4 4 alpha1],1,1);   %alfa1

%% C11 = 2*a1+ 2*a2+2*F1111*a3+ 2*(F1111+F1122+F1133)*a4+ 2*(F1111+F1122+F1133)*a5;
lmiterm([-1 1 1 0],2*(a1+a2));  %2*a1+ 2*a2
lmiterm([-1 1 1 0], 56 , 1/140 *(a3+a4+a5) );  %2* 1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))(a3+a4+a5);
lmiterm([-1 1 1 V1], 120 , 1/140 *(a3+a4+a5) );  %2* 1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))(a3+a4+a5);
lmiterm([-1 1 1 V5], -40 , 1/140 *(a3+a4+a5) );  %2* 1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))(a3+a4+a5);
lmiterm([-1 1 1 V6], 35 , 1/140 *(a3+a4+a5) );  %2* 1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))(a3+a4+a5);
lmiterm([-1 1 1 V10], -20 , 1/140 *(a3+a4+a5) );  %2* 1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))(a3+a4+a5);
lmiterm([-1 1 1 V14], 3 , 1/140 *(a3+a4+a5) );  %2* 1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))(a3+a4+a5);
%==============================
lmiterm([-1 1 1 0],56,2/840 * (a4+a5));  %2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))(a4+a5)
lmiterm([-1 1 1 V5],-40,2/840 * (a4+a5));  %2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))(a4+a5)
lmiterm([-1 1 1 V6],-105,2/840 * (a4+a5));  %2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))(a4+a5)
lmiterm([-1 1 1 V14],3,2/840 * (a4+a5));  %2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))(a4+a5)
%===================================================
lmiterm([-1 1 1 0],14,(2/210)*(a4+a5));  %2* 1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5);)(a4+a5)
lmiterm([-1 1 1 V1],15,(2/210)*(a4+a5));  %2* 1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5);)(a4+a5)
lmiterm([-1 1 1 V5],5,(2/210)*(a4+a5));  %2* 1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5);)(a4+a5)
lmiterm([-1 1 1 V10],15,(2/210)*(a4+a5));  %2* 1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5);)(a4+a5)
lmiterm([-1 1 1 V14],-3,(2/210)*(a4+a5));  %2* 1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5);)(a4+a5)

%% C12 = 2*a1+ 2*F1122*a3+ (F1111+F1122+F1133)*a4+ (F1122+F2222+F2233)*a4;
lmiterm([-1 1 2 0],2*a1);  %2a1
lmiterm([-1 1 2 0],56,a4*1/280);  % a4*(1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))
lmiterm([-1 1 2 V1],120,a4*1/280);  % a4*(1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))
lmiterm([-1 1 2 V5],-40,a4*1/280);  % a4*(1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))
lmiterm([-1 1 2 V6],35,a4*1/280);  % a4*(1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))
lmiterm([-1 1 2 V10],-20,a4*1/280);  % a4*(1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))
lmiterm([-1 1 2 V14],3,a4*1/280);  % a4*(1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))
%=========================
lmiterm([-1 1 2 0],56,(2/840)*(a3+a4));  %2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6);)(a3+a4)
lmiterm([-1 1 2 V5],-40,(2/840)*(a3+a4));  %2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6);)(a3+a4)
lmiterm([-1 1 2 V6],-105,(2/840)*(a3+a4));  %2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6);)(a3+a4)
lmiterm([-1 1 2 V14],3,(2/840)*(a3+a4));  %2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6);)(a3+a4)
%==========================
lmiterm([-1 1 2 0],14,a4/210);  %(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5)a4
lmiterm([-1 1 2 V1],15,a4/210);  %(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5)a4
lmiterm([-1 1 2 V5],5,a4/210);  %(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5)a4
lmiterm([-1 1 2 V10],15,a4/210);  %(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5)a4
lmiterm([-1 1 2 V14],-3,a4/210);  %(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5)a4
%============================
lmiterm([-1 1 2 0],56,a4/280);  %(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*a4
lmiterm([-1 1 2 V1],-120,a4/280);  %(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*a4
lmiterm([-1 1 2 V5],-40,a4/280);  %(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*a4
lmiterm([-1 1 2 V6],35,a4/280);  %(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*a4
lmiterm([-1 1 2 V10],20,a4/280);  %(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*a4
lmiterm([-1 1 2 V14],3,a4/280);  %(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*a4
%=============================
lmiterm([-1 1 2 0],14,a4/210);  %(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*a4
lmiterm([-1 1 2 V1],-15,a4/210);  %(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*a4
lmiterm([-1 1 2 V5],5,a4/210);  %(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*a4
lmiterm([-1 1 2 V10],-15,a4/210);  %(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*a4
lmiterm([-1 1 2 V15],-3,a4/210);  %(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*a4

%% C13 = 2*a1 + 2*F1133*a3 + (F1111+F1122+F1133)*a4 + (F1133+F2233+F3333)*a4;
lmiterm([-1 1 3 0],2*a1,1);  % 2a1
lmiterm([-1 1 3 0],14,(2/210)*(a3+a4));  % 2*(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5))*(a3+a4)
lmiterm([-1 1 3 V1],15,(2/210)*(a3+a4));  % 2*(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5))*(a3+a4)
lmiterm([-1 1 3 V5],5,(2/210)*(a3+a4));  % 2*(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5))*(a3+a4)
lmiterm([-1 1 3 15],V10,(2/210)*(a3+a4));  % 2*(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5))*(a3+a4)
lmiterm([-1 1 3 V14],-3,(2/210)*(a3+a4));  % 2*(1/210 * (14 + 15 *V1 + 15 *V10 - 3 *V14 + 5* V5))*(a3+a4)
%=================================
lmiterm([-1 1 3 0],56,(1/210)*a4);  % (1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))*a4
lmiterm([-1 1 3 V1],120,(1/210)*a4);  % (1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))*a4
lmiterm([-1 1 3 V5],-40,(1/210)*a4);  % (1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))*a4
lmiterm([-1 1 3 V6],35,(1/210)*a4);  % (1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))*a4
lmiterm([-1 1 3 V10],-20,(1/210)*a4);  % (1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))*a4
lmiterm([-1 1 3 V14],3,(1/210)*a4);  % (1/280 *(56 + 120 *V1 - 20 *V10 + 3 *V14 - 40 *V5 + 35 *V6))*a4
%=================================
lmiterm([-1 1 3 0],56,(1/840)*a4);  % a4*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))
lmiterm([-1 1 3 V5],-40,(1/840)*a4);  % a4*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))
lmiterm([-1 1 3 V6],-105,(1/840)*a4);  % a4*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))
lmiterm([-1 1 3 V14],3,(1/840)*a4);  % a4*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))
%=================================
lmiterm([-1 1 3 0],14,(1/210)*a4);  % a4*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))
lmiterm([-1 1 3 V1],-15,(1/210)*a4);  % a4*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))
lmiterm([-1 1 3 V5],5,(1/210)*a4);  % a4*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))
lmiterm([-1 1 3 V10],-15,(1/210)*a4);  % a4*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))
lmiterm([-1 1 3 V14],-3,(1/210)*a4);  % a4*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))
%===================================
lmiterm([-1 1 3 0],7,(1/35)*a4);  % a4*(1/35 *(7 + V14 + 10 *V5))
lmiterm([-1 1 3 V5],10,(1/35)*a4);  % a4*(1/35 *(7 + V14 + 10 *V5))
lmiterm([-1 1 3 V14],1,(1/35)*a4);  % a4*(1/35 *(7 + V14 + 10 *V5))

%% C14 = 4*F1123*a3+ 2*(F1123+F2223+F2333)*a4;
lmiterm([-1 1 4 V4],4,(4*a3+2*a4)/28);  %(1/28 *(V13 + 4 *V4 - 7 *V9))(4a3+2a4)
lmiterm([-1 1 4 V9],-7,(4*a3+2*a4)/28);  %(1/28 *(V13 + 4 *V4 - 7 *V9))(4a3+2a4)
lmiterm([-1 1 4 V13],1,(4*a3+2*a4)/28);  %(1/28 *(V13 + 4 *V4 - 7 *V9))(4a3+2a4)
%===================================
lmiterm([-1 1 4 V4],12,a4/14);  %(1/28 *(3* V13 + 12 *V4 + 7 * V9))(2*a4)
lmiterm([-1 1 4 V9],7,a4/14);  %(1/28 *(3* V13 + 12 *V4 + 7 * V9))(2*a4)
lmiterm([-1 1 4 V13],3,a4/14);  %(1/28 *(3* V13 + 12 *V4 + 7 * V9))(2*a4)
%====================================================
lmiterm([-1 1 4 V4],3,2*a4/7);  %(1/7 *(-V13 + 3 *V4))(2*a4)
lmiterm([-1 1 4 V13],-1,2*a4/7);  %(1/7 *(-V13 + 3 *V4))(2*a4)
%% C15 = 4*F1113*a3+ 2*(F1113+F1233+F1333)*a4;
lmiterm([-1 1 5 V3],12,(a3+a4)/28);  %4*( 1/28 *(-3 * V12 + 12* V3 + 7 *V8))*(a3+a4)
lmiterm([-1 1 5 V8],7,(a3+a4)/28);  %4*( 1/28 *(-3 * V12 + 12* V3 + 7 *V8))*(a3+a4)
lmiterm([-1 1 5 V12],-3,(a3+a4)/28);  %4*( 1/28 *(-3 * V12 + 12* V3 + 7 *V8))*(a3+a4)
%====================================================
lmiterm([-1 1 5 V2],2,a4/7);  % 2*a4*(1/14 *(-V11 + 2 * V2))
lmiterm([-1 1 5 V11],-1,a4/7);  % 2*a4*(1/14 *(-V11 + 2 * V2))
%====================================================
lmiterm([-1 1 5 V3],3, 2*a4/7);  % 2*a4*(1/7 *(V12 + 3 *V3))
lmiterm([-1 1 5 V12],1, 2*a4/7);  % 2*a4*(1/7 *(V12 + 3 *V3))

%% C16=4*F1112*a3+ 2*(F1112+F1222+F1233)*a4;
lmiterm([-1 1 6 V2], 24,(4*a3+2*a4)/56);  %(1/56 *(2* V11 + 24 * V2 - 7 * V7))(4*a3+2*a4)
lmiterm([-1 1 6 V7], -7,(4*a3+2*a4)/56);  %(1/56 *(2* V11 + 24 * V2 - 7 * V7))(4*a3+2*a4)
lmiterm([-1 1 6 V11], 2,(4*a3+2*a4)/56);  %(1/56 *(2* V11 + 24 * V2 - 7 * V7))(4*a3+2*a4)
%======================================================
lmiterm([-1 1 6 V2],24,2*a4/56);  % 2*a4*(1/56 *(2 * V11 + 24* V2 + 7* V7))
lmiterm([-1 1 6 V7],7,2*a4/56);  % 2*a4*(1/56 *(2 * V11 + 24* V2 + 7* V7))
lmiterm([-1 1 6 V11],2,2*a4/56);  % 2*a4*(1/56 *(2 * V11 + 24* V2 + 7* V7))
%=======================================================
lmiterm([-1 1 6 V2],2,a4/7);  % 2*a4*(1/14 *(-V11 + 2 * V2))
lmiterm([-1 1 6 V11],-1,a4/7);  % 2*a4*(1/14 *(-V11 + 2 * V2))
%% C22 = 2*a1+ 2*a2+ 2*F2222*a3+ 2*(F1122+F2222+F2233)*a4+ 2*(F1122+F2222+F2233)*a5;
lmiterm([-1 2 2 0],1,2*(a1+a2));  % 2*(a1+a2)
lmiterm([-1 2 2 0],56,2*(a4+a5)/840);  % 2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))*(a4+a5)
lmiterm([-1 2 2 V5],-40,2*(a4+a5)/840);  % 2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))*(a4+a5)
lmiterm([-1 2 2 V6],-105,2*(a4+a5)/840);  % 2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))*(a4+a5)
lmiterm([-1 2 2 V14],3,2*(a4+a5)/840);  % 2*(1/840 * (56 + 3 *V14 - 40* V5 - 105 *V6))*(a4+a5)
%========================================
lmiterm([-1 2 2 0],56,2*(a3+a4+a5)/280);  % 2*(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*(a3+a4+a5)
lmiterm([-1 2 2 V1],-120,2*(a3+a4+a5)/280);  % 2*(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*(a3+a4+a5)
lmiterm([-1 2 2 V5],-40,2*(a3+a4+a5)/280);  % 2*(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*(a3+a4+a5)
lmiterm([-1 2 2 V6],35,2*(a3+a4+a5)/280);  % 2*(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*(a3+a4+a5)
lmiterm([-1 2 2 V10],20,2*(a3+a4+a5)/280);  % 2*(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*(a3+a4+a5)
lmiterm([-1 2 2 V14],3,2*(a3+a4+a5)/280);  % 2*(1/280 *(56 - 120 *V1 + 20 *V10 + 3 *V14 - 40* V5 + 35 *V6))*(a3+a4+a5)
%=======================================
lmiterm([-1 2 2 0],14,2*(a4+a5)/210);  % 2*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*(a4+a5)
lmiterm([-1 2 2 V1],-15,2*(a4+a5)/210);  % 2*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*(a4+a5)
lmiterm([-1 2 2 V5],5,2*(a4+a5)/210);  % 2*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*(a4+a5)
lmiterm([-1 2 2 V10],-15,2*(a4+a5)/210);  % 2*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*(a4+a5)
lmiterm([-1 2 2 V14],-3,2*(a4+a5)/210);  % 2*(1/210 *(14 - 15 *V1 - 15 * V10 - 3 * V14 + 5 * V5))*(a4+a5)
%% C23 = 2*a1+2*F2233*a3+(F1122+F2222+F2233)*a4+(F1133+F2233+F3333)*a4;
%% C24 = 4*F2223*a3+2*(F1123+F2223+F2333)*a4;
%% C25 = 4*F1223*a3+2*(F1113+F1233+F1333)*a4;
%% C26 = 4*F1222*a3+2*(F1112+F1222+F1233)*a4;
%% C33 = 2*a1+2*a2+2*F3333*a3+2*(F1133+F2233+F3333)*a4+2*(F1133+F2233+F3333)*a5;
%% C34 = 4*F2333*a3+2*(F1123+F2223+F2333)*a4;
%% C35 = 4*F1333*a3+2*(F1113+F1233+F1333)*a4;
%% C36 = 4*F1233*a3+2*(F1112+F1222+F1233)*a4;
%% C44 = 8*F2233*a3+4*(F1123+F2223+F2333)*a5;
%% C45 = 8*F1233*a3;
%% C46 = 8*F1233*a3;
%% C55 = 8*F1133*a3+4*(F1113+F1233+F1333)*a5;
%% C56 = 8*F1123*a3;
%% C66 = 8*F1122*a3+4*(F1112+F1222+F1233)*a5;


%% LMI 2 (A V2;V2' alfa2) >= 0

lmiterm([-2 4 1 0], vv2(1));   %V1'
lmiterm([-2 4 2 0], vv2(2));   %V1'
lmiterm([-2 4 3 0], vv2(3));   %V1'
lmiterm([-2 4 4 alpha2],1,1);   %alfa1
% lmiterm([-2 1 4 0],vv2(1));   %V1'
% lmiterm([-2 2 4 0],vv2(2));   %V1'
% lmiterm([-2 3 4 0],vv2(3));   %V1'

% A11 =  U1 + U2.*V1 + U3.*V3;
lmiterm([-2 1 1 0],U1);  %U1
lmiterm([-2 1 1 V1],U2, 1);  %U2.*V1
lmiterm([-2 1 1 V3],U3, 1);  %U3.*V3
% A12 =  U4 - U3.*V3;
lmiterm([-2 1 2 0], U4);  %U4
lmiterm([-2 1 2 V3],U3 ,-1);  %U3.*V3

%A16 =  U2.*V2/2 + U3.*V4;
lmiterm([-2 1 3 V2], U2/2 , 1);  % U2.*V2/2
lmiterm([-2 1 3 V4], U3 , 1);  % U3.*V4

%A26 =  U2.*V2/2 - U3.*V4;
lmiterm([-2 2 3 V2],U2/2 , 1);  % U2.*V2/2
lmiterm([-2 2 3 V4],U3 ,-1);  % U3.*V4

%A22 =  U1 - U2.*V1 + U3.*V3;
lmiterm([-2 2 2 0],U1);  %U1
lmiterm([-2 2 2 V1],U2 ,-1);  % U2.*V1
lmiterm([-2 2 2 V3], U3 , 1);  % U3.*V3

%A66 =  U5 - U3.*V3;

lmiterm([-2 3 3 0], U5);  %U5
lmiterm([-2 3 3 V3], U3 ,-1);  % U3.*V3
%============================================

%% LMI 3 (A V3;V3' alfa3) >= 0

lmiterm([-3 4 1 0], vv3(1));   %V1'
lmiterm([-3 4 2 0], vv3(2));   %V1'
lmiterm([-3 4 3 0], vv3(3));   %V1'
lmiterm([-3 4 4 alpha3],1,1);   %alfa1
% lmiterm([-3 1 4 0],vv3(1));   %V1'
% lmiterm([-3 2 4 0],vv3(2));   %V1'
% lmiterm([-3 3 4 0],vv3(3));   %V1'

% A11 =  U1 + U2.*V1 + U3.*V3;
lmiterm([-3 1 1 0], U1);  %U1
lmiterm([-3 1 1 V1], U2 , 1);  %U2.*V1
lmiterm([-3 1 1 V3], U3 , 1);  %U3.*V3
% A12 =  U4 - U3.*V3;
lmiterm([-3 1 2 0], U4);  %U4
lmiterm([-3 1 2 V3], U3 ,-1);  %U3.*V3

%A16 =  U2.*V2/2 + U3.*V4;
lmiterm([-3 1 3 V2], U2/2, 1);  % U2.*V2/2
lmiterm([-3 1 3 V4], U3, 1);  % U3.*V4

%A26 =  U2.*V2/2 - U3.*V4;
lmiterm([-3 2 3 V2], U2/2, 1);  % U2.*V2/2
lmiterm([-3 2 3 V4], U3,-1);  % U3.*V4

%A22 =  U1 - U2.*V1 + U3.*V3;
lmiterm([-3 2 2 0], U1);  %U1
lmiterm([-3 2 2 V1], U2, -1);  % U2.*V1
lmiterm([-3 2 2 V3], U3, 1);  % U3.*V3

%A66 =  U5 - U3.*V3;

lmiterm([-3 3 3 0], U5);  %U5
lmiterm([-3 3 3 V3], U3,-1);  % U3.*V3

%==========================================

% LMI 4 F >= 0
lmiterm([-4 1 1 0], 3);   %CONSTANT = 3
lmiterm([-4 1 1 V1], 4,1);   %4V1
lmiterm([-4 1 1 V3], 1,1);   % V3

lmiterm([-4 1 2 V2], 4,1);   % 4V2 
lmiterm([-4 1 2 V4], 2,1);   % 2V4


lmiterm([-4 1 3 0], 1);   % CONSTANT = 1 
lmiterm([-4 1 3 V3], -1,1);   % -1 * V3


lmiterm([-4 2 2 0], 4);   % CONSTANT = 4 
lmiterm([-4 2 2 V3], 4,-1);   % -4 * V3

lmiterm([-4 2 3 V2], 4,1);   % 4 V2 
lmiterm([-4 2 3 V4], 2,-1);   % -2 V4


lmiterm([-4 3 3 0],3);   % CONSTANT = 3 
lmiterm([-4 3 3 V1],-4,1);   % - 4 V2 
lmiterm([-4 3 3 V3],1,1);   %  V3


lmiterm([-4 2 1 V2], 4,1);   % 4V2 
lmiterm([-4 2 1 V4], 2,1);   % 2V4

lmiterm([-4 3 1 0], 1);   % CONSTANT = 1 
lmiterm([-4 3 1 V3], -1,1);   % -1 * V3


lmiterm([-4 3 2 V2], 4,1);   % 4 V2 
lmiterm([-4 3 2 V4], -2,1);   % -2 V4



%=========================================

%Create the LMI system
lmisys = getlmis;
options = [1e-20, 100, -1, 5, 1];
[copt, xopt] = mincx (lmisys, c , options);
xval_opt = xopt;
evals = evallmi(lmisys,xopt);
% [lhs1,rhs1] = showlmi(evals,1) 
% [lhs2,rhs2] = showlmi(evals,2)
% [lhs2,rhs2] = showlmi(evals,3)
% [lhs2,rhs2] = showlmi(evals,4)

