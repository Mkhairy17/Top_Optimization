% function [KE,cm] = Elementstiffness(a,b,c11,c12,c13,c22,c33)

s_6 = [c11 c12 c13 c14 c15 c16;c12 c22 c23 c24 c25 c26;c13 c23 c33 c34 c35 c36;c14 c24 c34 c44 c45 c46;c15 c25 c35 c45 c55 c56;c16 c26 c36 c46 c56 c66];
c= inv(s_6);

cm = c([1 2 6],[1 2 6])-c([1 2 6],[3 4 5])*inv(c([3 4 5],[3 4 5]))*c([3 4 5],[1 2 6]);

KE = (1/12)*[4*b*cm(1,1)/a+3*(cm(1,3)+cm(3,1))+4*a*cm(3,3)/b, 3*cm(1,2)+4*b*cm(1,3)/a+4*a*cm(3,2)/b+3*cm(3,3),-4*b*cm(1,1)/a+3*cm(1,3)-3*cm(3,1)+2*a*cm(3,3)/b,3*cm(1,2)-4*b*cm(1,3)/a+2*a*cm(3,2)/b-3*cm(3,3),-2*b*cm(1,1)/a-3*(cm(1,3)+cm(3,1))-2*a*cm(3,3)/b,-3*cm(1,2)-2*b*cm(1,3)/a-2*a*cm(3,2)/b-3*cm(3,3),2*b*cm(1,1)/a-3*cm(1,3)+3*cm(3,1)-4*a*cm(3,3)/b,-3*cm(1,2)+2*b*cm(1,3)/a-4*a*cm(3,2)/b+3*cm(3,3);...
             3*cm(1,2)+4*a*cm(2,3)/b+4*b*cm(3,1)/a+3*cm(3,3),4*a*cm(2,2)/b+3*(cm(2,3)+cm(3,2))+4*b*cm(3,3)/a,-3*cm(1,2)+2*a*cm(2,3)/b-4*a*cm(3,1)/a+3*cm(3,3),2*a*cm(2,2)/b-3*cm(2,3)+3*cm(3,2)-4*b*cm(3,3)/a,-3*cm(1,2)-2*a*cm(2,3)/b-2*b*cm(3,1)/a-3*cm(3,3),-2*a*cm(2,2)/b-3*(cm(2,3)+cm(3,2))-2*b*cm(3,3)/a,3*cm(1,2)-4*a*cm(2,3)+2*b*cm(3,1)/a-3*cm(3,3),-4*a*cm(2,2)/b+3*cm(2,3)-3*cm(3,2)+2*b*cm(3,3)/a;...
             -4*b*cm(1,1)/a-3*cm(1,3)+3*cm(3,1)+2*a*cm(3,3)/b,-3*cm(1,2)-4*b*cm(1,3)/a+2*a*cm(3,2)/b+3*cm(3,3),4*b*cm(1,1)/a-3*(cm(1,3)+cm(3,1))+4*a*cm(3,3)/b,-3*cm(1,2)+4*b*cm(1,3)/a+4*a*cm(3,2)/b-3*cm(3,3),2*b*cm(1,1)/a+3*cm(1,3)-3*cm(3,1)-4*a*cm(3,3)/b,3*cm(1,2)+2*b*cm(1,3)/a-4*a*cm(3,2)/b-3*cm(3,3),-2*b*cm(1,1)/a+3*(cm(1,3)+cm(3,1))-2*a*cm(3,3)/b,3*cm(1,2)-2*b*cm(1,3)/a-2*a*cm(3,2)/b+3*cm(3,3);...
             3*cm(1,2)+2*a*cm(2,3)/b-4*b*cm(3,1)/a-3*cm(3,3),2*a*cm(2,2)/b+3*cm(2,3)-3*cm(3,2)-4*b*cm(3,3)/a,-3*cm(1,2)+4*a*cm(2,3)/b+4*b*cm(3,1)/a-3*cm(3,3),4*a*cm(2,2)/b-3*(cm(2,3)+cm(3,2))+4*b*cm(3,3)/a,-3*cm(1,2)-4*a*cm(2,3)/b+2*b*cm(3,1)/a+3*cm(3,3),-4*a*cm(2,2)/b-3*cm(2,3)+3*cm(3,2)+2*b*cm(3,3)/a,3*cm(1,2)-2*a*cm(3,1)/a+3*cm(3,3),-2*a*cm(2,2)/b+3*(cm(2,3)+cm(3,2))-2*b*cm(3,3)/a;...
             -2*b*cm(1,1)/a-3*(cm(1,3)+cm(3,1))-2*a*cm(3,3)/b,-3*cm(1,2)-2*b*cm(1,3)/a-2*a*cm(3,2)/b-3*cm(3,3),2*b*cm(1,1)/a-3*cm(1,3)+3*cm(3,1)-4*a*cm(3,3)/b,-3*cm(1,2)+2*b*cm(1,3)/a-4*a*cm(3,2)/b+3*cm(3,3),4*b*cm(1,1)/a+3*(cm(1,3)+cm(3,1))+4*a*cm(3,3)/b,3*cm(1,2)+4*b*cm(1,3)/a+4*a*cm(3,2)/b+3*cm(3,3),-4*b*cm(1,1)/a+3*cm(1,3)-3*cm(3,1)+2*a*cm(3,3)/b,3*cm(1,2)-4*b*cm(1,3)/a+2*a*cm(3,2)/b-3*cm(3,3);...
             -3*cm(1,2)-2*a*cm(2,3)/b-2*b*cm(3,1)/a-3*cm(3,3),-2*a*cm(2,2)/b-3*(cm(2,3)+cm(3,2))-2*b*cm(3,3)/a,3*cm(1,2)-4*a*cm(2,3)/b+2*b*cm(3,1)/a-3*cm(3,3),-4*a*cm(2,2)/b+3*cm(2,3)-3*cm(3,2)+2*b*cm(3,3)/a,3*cm(1,2)+4*a*cm(2,3)+4*b*cm(3,1)+3*cm(3,3),4*a*cm(2,2)/b+3*(cm(2,3)+cm(3,2))+4*b*cm(3,3)/a,-3*cm(1,2)+2*a*cm(2,3)/b-4*b*cm(3,1)/a+3*cm(3,3),2*a*cm(2,2)/b-3*cm(2,3)+3*cm(3,2)-4*b*cm(3,3)/a;...
             2*b*cm(1,1)/a+3*cm(1,3)-3*cm(3,1)-4*a*cm(3,3)/b,3*cm(1,2)+2*b*cm(1,3)/a-4*a*cm(3,2)/b-3*cm(3,3),-2*b*cm(1,1)/a+3*(cm(1,3)+cm(3,1))-2*a*cm(3,3)/b,3*cm(1,2)-2*b*cm(1,3)/a-2*a*cm(3,2)/b+3*cm(3,3),-4*b*cm(1,1)/a+3*cm(1,3)+3*cm(3,1)+2*a*cm(3,3)/b,-3*cm(1,2)-4*b*cm(1,3)/a+2*a*cm(3,2)/b+3*cm(3,3),4*b*cm(1,1)/a-3*(cm(1,3)+cm(3,1))+4*a*cm(3,3)/b,-3*cm(1,2)+4*b*cm(1,3)/a+4*a*cm(3,2)/b-3*cm(3,3);...
             -3*cm(1,2)-4*a*cm(2,3)/b+2*b*cm(3,1)/a+3*cm(3,3),-4*a*cm(2,2)/b-3*cm(2,3)+3*cm(3,2)+2*b*cm(3,3)/a,3*cm(1,2)-2*a*cm(2,3)/b-2*b*cm(3,1)/a+3*cm(3,3),-2*a*cm(2,2)/b+3*(cm(2,3)+cm(3,2))-2*b*cm(3,3)/a,3*cm(1,2)+2*a*cm(2,3)/b-4*b*cm(3,1)/a-3*cm(3,3),2*a*cm(2,2)/b+2*cm(2,3)-3*cm(3,2)-4*b*cm(3,3)/a,-3*cm(1,2)+4*a*cm(2,3)/b+4*b*cm(3,1)/a-3*cm(3,3),4*a*cm(2,2)/b-3*(cm(2,3)+cm(3,2))+4*b*cm(3,3)/a];
                   

end

