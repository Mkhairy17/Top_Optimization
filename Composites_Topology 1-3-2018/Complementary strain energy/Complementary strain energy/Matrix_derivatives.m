function [KE_A11,KE_A22,KE_A66,KE_A12,KE_A16,KE_A26] = Matrix_derivatives(a1,a2)
syms A11 A12 A16 A26 A22 A66 a b
KE = (1/12)*[4*b*A11/a+3*(A16+A16)+4*a*A66/b, 3*A12+4*b*A16/a+4*a*A26/b+3*A66,-4*b*A11/a+3*A16-3*A16+2*a*A66/b,3*A12-4*b*A16/a+2*a*A26/b-3*A66,-2*b*A11/a-3*(A16+A16)-2*a*A66/b,-3*A12-2*b*A16/a-2*a*A26/b-3*A66,2*b*A11/a-3*A16+3*A16-4*a*A66/b,-3*A12+2*b*A16/a-4*a*A26/b+3*A66;...
             3*A12+4*a*A26/b+4*b*A16/a+3*A66,4*a*A22/b+3*(A26+A26)+4*b*A66/a,-3*A12+2*a*A26/b-4*a*A16/a+3*A66,2*a*A22/b-3*A26+3*A26-4*b*A66/a,-3*A12-2*a*A26/b-2*b*A16/a-3*A66,-2*a*A22/b-3*(A26+A26)-2*b*A66/a,3*A12-4*a*A26+2*b*A16/a-3*A66,-4*a*A22/b+3*A26-3*A26+2*b*A66/a;...
             -4*b*A11/a-3*A16+3*A16+2*a*A66/b,-3*A12-4*b*A16/a+2*a*A26/b+3*A66,4*b*A11/a-3*(A16+A16)+4*a*A66/b,-3*A12+4*b*A16/a+4*a*A26/b-3*A66,2*b*A11/a+3*A16-3*A16-4*a*A66/b,3*A12+2*b*A16/a-4*a*A26/b-3*A66,-2*b*A11/a+3*(A16+A16)-2*a*A66/b,3*A12-2*b*A16/a-2*a*A26/b+3*A66;...
             3*A12+2*a*A26/b-4*b*A16/a-3*A66,2*a*A22/b+3*A26-3*A26-4*b*A66/a,-3*A12+4*a*A26/b+4*b*A16/a-3*A66,4*a*A22/b-3*(A26+A26)+4*b*A66/a,-3*A12-4*a*A26/b+2*b*A16/a+3*A66,-4*a*A22/b-3*A26+3*A26+2*b*A66/a,3*A12-2*a*A16/a+3*A66,-2*a*A22/b+3*(A26+A26)-2*b*A66/a;...
             -2*b*A11/a-3*(A16+A16)-2*a*A66/b,-3*A12-2*b*A16/a-2*a*A26/b-3*A66,2*b*A11/a-3*A16+3*A16-4*a*A66/b,-3*A12+2*b*A16/a-4*a*A26/b+3*A66,4*b*A11/a+3*(A16+A16)+4*a*A66/b,3*A12+4*b*A16/a+4*a*A26/b+3*A66,-4*b*A11/a+3*A16-3*A16+2*a*A66/b,3*A12-4*b*A16/a+2*a*A26/b-3*A66;...
             -3*A12-2*a*A26/b-2*b*A16/a-3*A66,-2*a*A22/b-3*(A26+A26)-2*b*A66/a,3*A12-4*a*A26/b+2*b*A16/a-3*A66,-4*a*A22/b+3*A26-3*A26+2*b*A66/a,3*A12+4*a*A26+4*b*A16+3*A66,4*a*A22/b+3*(A26+A26)+4*b*A66/a,-3*A12+2*a*A26/b-4*b*A16/a+3*A66,2*a*A22/b-3*A26+3*A26-4*b*A66/a;...
             2*b*A11/a+3*A16-3*A16-4*a*A66/b,3*A12+2*b*A16/a-4*a*A26/b-3*A66,-2*b*A11/a+3*(A16+A16)-2*a*A66/b,3*A12-2*b*A16/a-2*a*A26/b+3*A66,-4*b*A11/a+3*A16+3*A16+2*a*A66/b,-3*A12-4*b*A16/a+2*a*A26/b+3*A66,4*b*A11/a-3*(A16+A16)+4*a*A66/b,-3*A12+4*b*A16/a+4*a*A26/b-3*A66;...
             -3*A12-4*a*A26/b+2*b*A16/a+3*A66,-4*a*A22/b-3*A26+3*A26+2*b*A66/a,3*A12-2*a*A26/b-2*b*A16/a+3*A66,-2*a*A22/b+3*(A26+A26)-2*b*A66/a,3*A12+2*a*A26/b-4*b*A16/a-3*A66,2*a*A22/b+2*A26-3*A26-4*b*A66/a,-3*A12+4*a*A26/b+4*b*A16/a-3*A66,4*a*A22/b-3*(A26+A26)+4*b*A66/a];
                   



KE_A11 = double(subs(diff(KE,A11),[a,b],[a1,a2]));
KE_A12 = double(subs(diff(KE,A12),[a,b],[a1,a2]));
KE_A16 = double(subs(diff(KE,A16),[a,b],[a1,a2]));
KE_A26 = double(subs(diff(KE,A26),[a,b],[a1,a2]));
KE_A22 = double(subs(diff(KE,A22),[a,b],[a1,a2]));
KE_A66 = double(subs(diff(KE,A66),[a,b],[a1,a2]));

